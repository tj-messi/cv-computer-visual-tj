#12.1目标定位

![](https://cdn.jsdelivr.net/gh/tj-messi/picture/20241004105636.png)

图片分类任务我们已经熟悉了，就是算法遍历图片，判断其中的对象是不是汽车，这就是图片分类。这节课我们要学习构建神经网络的另一个问题，即定位分类问题。这意味着，我们不仅要用算法判断图片中是不是一辆汽车，还要在图片中标记出它的位置，用边框或红色方框把汽车圈起来，这就是定位分类问题。其中“定位”的意思是判断汽车在图片中的具体位置。这周后面几天，我们再讲讲当图片中有多个对象时，应该如何检测它们，并确定出位置。比如，你正在做一个自动驾驶程序，程序不但要检测其它车辆，还要检测其它对象，如行人、摩托车等等，稍后我们再详细讲

我们要研究的分类定位问题，通常只有一个较大的对象位于图片中间位置，我们要对它进行识别和定位。而在对象检测问题中，图片可以含有多个对象，甚至单张图片中会有多个不同分类的对象。因此，图片分类的思路可以帮助学习分类定位，而对象定位的思路又有助于学习对象检测，我们先从分类和定位开始讲起。

图片分类问题你已经并不陌生了，例如，输入一张图片到多层卷积神经网络。这就是卷积神经网络，它会输出一个特征向量，并反馈给softmax单元来预测图片类型

![](https://cdn.jsdelivr.net/gh/tj-messi/picture/20241004110611.png)

这就是标准的分类过程，如果你还想定位图片中汽车的位置，该怎么做呢？我们可以让神经网络多输出几个单元，输出一个边界框。具体说就是让神经网络再多输出4个数字，标记为 b x , b y , b h b_x,b_y,b_hb 
x
​
 ,b 
y
​
 ,b 
h
​
  和 b w b_wb 
w
​
  ，这四个数字是被检测对象的边界框的参数化表示。

我们先来约定本周课程将使用的符号表示，图片左上角的坐标为(0,0)，右下角标记为(1,1)。要确定边界框的具体位置，需要指定红色方框的中心点，这个点表示为(b x , b y b_x,b_yb 
x
​
 ,b 
y
​
 )，边界框的高度为 b h b_hb 
h
​
  ，宽度为 b w b_wb 
w
​
  。因此训练集不仅包含神经网络要预测的对象分类标签，还要包含表示边界框的这四个数字，接着采用监督学习算法，输出一个分类标签，还有四个参数值，从而给出检测对象的边框位置。此例中， b x b_xb 
x
​
  的理想值是0.5，因为它表示汽车位于图片水平方向的中间位置；b y b_yb 
y
​
  大约是0.7，表示汽车位于距离图片底部 3 10 \frac3{10} 
10
3
​
  的位置； b h b_hb 
h
​
  约为0.3，因为红色方框的高度是图片高度的0.3倍； b w b_wb 
w
​
  约为0.4，红色方框的宽度是图片宽度的0.4倍

![](https://cdn.jsdelivr.net/gh/tj-messi/picture/20241004110658.png)

###目标标签y

![](https://cdn.jsdelivr.net/gh/tj-messi/picture/20241004110813.png)

它是一个向量，第一个组件 p c p_cp 
c
​
  表示是否含有对象，如果对象属于前三类（行人、汽车、摩托车），则 p c = 1 p_c=1p 
c
​
 =1 ，如果是背景，则图片中没有要检测的对象，则 p c = 0 p_c=0p 
c
​
 =0 。我们可以这样理解 p c p_cp 
c
​
  ，它表示被检测对象属于某一分类的概率，背景分类除外。

如果检测到对象，就输出被检测对象的边界框参数 b x 、 b y 、 b h b_x、b_y、b_hb 
x
​
 、b 
y
​
 、b 
h
​
  和 b w b_wb 
w
​
  。最后，如果存在某个对象，那么 p c = 1 p_c=1p 
c
​
 =1 ，同时输出 c 1 、 c 2 c_1、c_2c 
1
​
 、c 
2
​
  和 c 3 c_3c 
3
​
  ，表示该对象属于1-3类中的哪一类，是行人，汽车还是摩托车。鉴于我们所要处理的问题，我们假设图片中只含有一个对象，所以针对这个分类定位问题，图片最多只会出现其中一个对象


最后，我们介绍一下神经网络的损失函数，其参数为类别 y yy 和网络输出 y ^ \hat{y} 
y
^
​
  ，如果采用平方误差策略，则 L ( y ^ , y ) = ( y ^ 1 − y 1 ) 2 + ( y ^ 2 − y 2 ) 2 + ⋯ + ( y ^ 8 − y 8 ) 2 L(\hat{y},y)=(\hat{y}_1-y_1)^2+(\hat{y}_2-y_2)^2+\cdots+(\hat{y}_8-y_8)^2L( 
y
^
​
 ,y)=( 
y
^
​
  
1
​
 −y 
1
​
 ) 
2
 +( 
y
^
​
  
2
​
 −y 
2
​
 ) 
2
 +⋯+( 
y
^
​
  
8
​
 −y 
8
​
 ) 
2

![](https://cdn.jsdelivr.net/gh/tj-messi/picture/20241004111836.png)

