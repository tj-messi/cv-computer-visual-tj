#14.5 人脸验证和二分类

Triplet loss是一个学习人脸识别卷积网络参数的好方法，还有其他学习参数的方法，让我们看看如何将人脸识别当成一个二分类问题

![](https://cdn.jsdelivr.net/gh/tj-messi/picture/20241008002646.png)

另一个训练神经网络的方法是选取一对神经网络，选取Siamese网络，使其同时计算这些嵌入，比如说128维的嵌入（编号1），或者更高维，然后将其输入到逻辑回归单元，然后进行预测，如果是相同的人，那么输出是1，若是不同的人，输出是0。这就把人脸识别问题转换为一个二分类问题，训练这种系统时可以替换Triplet loss的方法

![](https://cdn.jsdelivr.net/gh/tj-messi/picture/20241008002851.png)

![](https://cdn.jsdelivr.net/gh/tj-messi/picture/1728359143274.png)

![](https://cdn.jsdelivr.net/gh/tj-messi/picture/20241008114634.png)

![](https://cdn.jsdelivr.net/gh/tj-messi/picture/1728359717283.png)

![](https://cdn.jsdelivr.net/gh/tj-messi/picture/20241008115622.png)

但是在这个学习公式中，输入是一对图片，这是你的训练输入 x xx （编号1、2），输出 y yy 是0或者1，取决于你的输入是相似图片还是非相似图片。与之前类似，你正在训练一个Siamese网络，意味着上面这个神经网络拥有的参数和下面神经网络的相同（编号3和4所示的网络），两组参数是绑定的，这样的系统效果很好。

之前提到一个计算技巧可以帮你显著提高部署效果，如果这是一张新图片（编号1），当员工走进门时，希望门可以自动为他们打开，这个（编号2）是在数据库中的图片，不需要每次都计算这些特征（编号6），不需要每次都计算这个嵌入，你可以提前计算好，那么当一个新员工走近时，你可以使用上方的卷积网络来计算这些编码（编号5），然后使用它，和预先计算好的编码进行比较，然后输出预测值 y ^ \hat{y} 
y
^
​
  。

因为不需要存储原始图像，如果你有一个很大的员工数据库，你不需要为每个员工每次都计算这些编码。这个预先计算的思想，可以节省大量的计算，这个预训练的工作可以用在Siamese网路结构中，将人脸识别当作一个二分类问题，也可以用在学习和使用Triplet loss函数上，我在之前的视频中描述过。

总结一下，把人脸验证当作一个监督学习，创建一个只有成对图片的训练集，不是三个一组，而是成对的图片，目标标签是1表示一对图片是一个人，目标标签是0表示图片中是不同的人。利用不同的成对图片，使用反向传播算法去训练神经网络，训练Siamese神经网络

![](https://cdn.jsdelivr.net/gh/tj-messi/picture/20241008115720.png)
