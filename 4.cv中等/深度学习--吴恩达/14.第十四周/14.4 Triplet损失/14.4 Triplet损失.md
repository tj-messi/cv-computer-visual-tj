#14.4 Triplet损失

要想通过学习神经网络的参数来得到优质的人脸图片编码，方法之一就是定义三元组损失函数然后应用梯度下降

我们看下这是什么意思，为了应用三元组损失函数，你需要比较成对的图像，比如这个图片，为了学习网络的参数，你需要同时看几幅图片，比如这对图片（编号1和编号2），你想要它们的编码相似，因为这是同一个人。然而假如是这对图片（编号3和编号4），你会想要它们的编码差异大一些，因为这是不同的人。

用三元组损失的术语来说，你要做的通常是看一个 Anchor 图片，你想让Anchor图片和Positive图片（Positive意味着是同一个人）的距离很接近。然而，当Anchor图片与Negative图片（Negative意味着是非同一个人）对比时，你会想让他们的距离离得更远一点

![](https://cdn.jsdelivr.net/gh/tj-messi/picture/20241007235750.png)

这就是为什么叫做三元组损失，它代表你通常会同时看三张图片，你需要看Anchor图片、Postive图片，还有Negative图片，我要把Anchor图片、Positive图片和Negative图片简写成 A 、 P 、 N 

![](https://cdn.jsdelivr.net/gh/tj-messi/picture/1728316756491.png)

![](https://cdn.jsdelivr.net/gh/tj-messi/picture/20241007235957.png)

![](https://cdn.jsdelivr.net/gh/tj-messi/picture/1728317268577.png)

![](https://cdn.jsdelivr.net/gh/tj-messi/picture/20241008000918.png)

![](https://cdn.jsdelivr.net/gh/tj-messi/picture/1728317564319.png)

![](https://cdn.jsdelivr.net/gh/tj-messi/picture/20241008001501.png)

三元组损失函数的定义基于三张图片，假如三张图片 A 、 P 、 N、即Anchor样本、Positive样本和Negative样本，其中Positive图片和Anchor图片是同一个人，但是Negative图片和Anchor不是同一个人。

![](https://cdn.jsdelivr.net/gh/tj-messi/picture/20241008001543.png)

![](https://cdn.jsdelivr.net/gh/tj-messi/picture/1728317808894.png)

![](https://cdn.jsdelivr.net/gh/tj-messi/picture/20241008001703.png)

