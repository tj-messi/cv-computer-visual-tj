#3.建设自己的深层神经网络

##题目

![](https://cdn.jsdelivr.net/gh/tj-messi/picture/1725549223880.png)

##1.需要的包

	import time
	import numpy as np
	import h5py
	import matplotlib.pyplot as plt
	import scipy
	from PIL import Image
	from scipy import ndimage
	from dnn_app_utils_v2 import *

	plt.rcParams['figure.figsize'] = (5.0, 4.0) # set default size of plots
	plt.rcParams['image.interpolation'] = 'nearest'
	plt.rcParams['image.cmap'] = 'gray'

	np.random.seed(1)

注意h5py包是用于读取.h5后缀的数据集文件

##2.数据集

先取出数据集

	train_x_orig, train_y, test_x_orig, test_y, classes = load_data()

然后取出数据的一些数量数据

	m_train = train_x_orig.shape[0]
	num_px = train_x_orig.shape[1]
	m_test = test_x_orig.shape[0]

然后把图片分解成X特征向量

![](https://cdn.jsdelivr.net/gh/tj-messi/picture/1725588424724.png)

统一的重新设置好数据集的大小，然后标准化数据

	# 统一重新调整图片大小
	train_x_flatten = train_x_orig.reshape(train_x_orig.shape[0], -1).T
	test_x_flatten = test_x_orig.reshape(test_x_orig.shape[0], -1).T

	# 标准化数据在0到1之间
	train_x = train_x_flatten/255.
	test_x = test_x_flatten/255.


##3.构建model

在进阶的神经网络中，可以构建不同的model

1. 双层的神经网络
2. L-层的神经网络

###3.1 双层神经网络

![](https://cdn.jsdelivr.net/gh/tj-messi/picture/1725589252721.png)

流程简化为：input->relu->sigmoid->output

###3.2 L-层神经网络

![](https://cdn.jsdelivr.net/gh/tj-messi/picture/1725589560698.png)

流程简化为 input->relu^L times->sigmoid->output

###3.3 总的办法

像平时一样，在初始化参数之后

反复执行以下步骤：

1.前向传播

2.计算成本函数

3.后向传播再梯度下降法更新参数

##4.